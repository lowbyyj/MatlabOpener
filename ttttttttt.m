altitude = [58.87250518798828 59.501365661621094 60.354820251464844 62.357666015625 64.82554626464844 66.89180755615234 68.5960693359375 70.64647674560547 71.86456298828125 73.53712463378906 74.3060302734375 74.77899169921875 76.08956146240234 76.5255355834961 77.00114440917969 77.57451629638672 77.84931945800781 78.63407135009766 78.79788970947266 78.91150665283203 79.15724182128906 79.10968017578125 79.63021087646484 79.6513442993164 79.70155334472656 79.7755355834961 80.6131362915039 81.8787841796875 83.123291015625 85.02044677734375 86.65337371826172 89.04991149902344 90.71190643310547 92.96576690673828 95.01616668701172 97.06393432617188 99.1566162109375 100.93486022949219 101.98384857177734 103.14380645751953 103.32876586914062 103.93119812011719 104.65518188476562 105.68302917480469 106.24054718017578 106.71880340576172 107.14949035644531 107.93952941894531 108.00294494628906 107.61717224121094 107.46392059326172 107.58018493652344 108.40985870361328 108.65294647216797 109.12855529785156 109.05721282958984 108.21168518066406 108.39400482177734 109.75212860107422 109.99522399902344 109.99522399902344 107.8681869506836 106.0793685913086 104.66575622558594 103.5242919921875 101.80945587158203 100.35620880126953 98.84217834472656 97.151123046875 95.5102767944336 93.94340515136719 92.4478759765625 90.9259262084961 89.52816772460938 87.50682830810547 86.30987548828125 85.04686737060547 83.38488006591797 82.09281158447266 81.1125259399414 80.66069793701172 79.93142700195312 79.7174072265625 79.2550048828125 78.60236358642578 78.40947723388672 78.08975982666016 78.1954574584961 79.13874816894531 79.34484100341797 79.31578063964844 79.173095703125 78.91679382324219 78.85602569580078 78.83488464355469 78.9062271118164 79.02777099609375 78.92736053466797 78.92208099365234 79.37126922607422 79.96049499511719 81.00154876708984 82.6106948852539 84.32024383544922 86.19625854492188 88.20174407958984 89.8108901977539 92.51921844482422 94.27633666992188 96.38751220703125 98.0679931640625 99.90966033935547 101.52409362792969 102.77388763427734 103.84928894042969 104.49665069580078 105.37388610839844 105.8125 106.18241882324219 106.51799011230469 107.9368896484375 108.25924682617188 108.52347564697266 108.49969482421875 108.77449035644531 108.84318542480469 109.01493835449219 109.00701141357422 103.66961669921875 102.35376739501953 101.19644927978516 99.54766845703125 98.20011138916016 96.7653579711914 95.06372833251953 94.69645690917969 82.53935241699219 81.6700439453125 80.84565734863281 80.0899658203125 79.56414794921875 79.2999267578125 78.8243179321289 78.591796875 78.31964111328125 78.17960357666016 78.33020782470703 78.37248992919922 78.32228088378906 75.76191711425781 74.52533721923828 72.97431945800781 71.3017578125 69.99647521972656 68.22087097167969 66.64871978759766 65.58123779296875 64.3314437866211 62.3867301940918 61.21884536743164 59.47758483886719 58.00584030151367 ];
latitude = [37.4499762763741 37.4499762763741 37.44996881737555 37.44996881737555 37.449964288833655 37.449964288833655 37.44995932834631 37.44995932834631 37.449956012429645 37.449956012429645 37.44994999309878 37.44994999309878 37.449948059555965 37.449948059555965 37.44994627417736 37.44994627417736 37.44993469121613 37.44993469121613 37.44992972604143 37.44992972604143 37.449927085252526 37.449927085252526 37.44992832791745 37.44992832791745 37.449929625406526 37.449929625406526 37.449928235072925 37.449928235072925 37.44992661913488 37.44992661913488 37.4499321676176 37.4499321676176 37.44994137469606 37.44994137469606 37.44995688443256 37.44995688443256 37.44999310578366 37.44999310578366 37.45002539192658 37.45002539192658 37.45006718735343 37.45006718735343 37.45010584323347 37.45010584323347 37.450139685816964 37.450139685816964 37.45018288433543 37.45018288433543 37.450216236535624 37.450216236535624 37.45023793946482 37.45023793946482 37.45025463139283 37.45025463139283 37.45026593688744 37.45026593688744 37.450283916667196 37.450283916667196 37.45030141568934 37.45030141568934 37.4502982285052 37.4502982285052 37.45030247049642 37.4507721 37.4503099711643 37.4503099711643 37.45031555081039 37.45031555081039 37.450320447293514 37.450320447293514 37.45032498395647 37.45032498395647 37.450328423284546 37.450328423284546 37.450331993813755 37.450331993813755 37.45033107898127 37.45033107898127 37.45033161246021 37.45033161246021 37.450285672833154 37.450285672833154 37.450285513403564 37.450285513403564 37.450274692932496 37.450274692932496 37.450271701277764 37.450271701277764 37.450274221500656 37.450274221500656 37.45027712898311 37.45027712898311 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.45027907426289 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 37.4500067 ];
longitude = [126.95112154823099 126.95112154823099 126.95112040910104 126.95112040910104 126.95111890156846 126.95111890156846 126.9511148261583 126.9511148261583 126.95110350005864 126.95110350005864 126.95109477499277 126.95109477499277 126.95109403654104 126.95109403654104 126.95109398519921 126.95109398519921 126.95108874073756 126.95108874073756 126.95108862349916 126.95108862349916 126.95108829668276 126.95108829668276 126.95108930802641 126.95108930802641 126.95108405458042 126.95108405458042 126.9510850771181 126.9510850771181 126.95108555281429 126.95108555281429 126.95108214440185 126.95108214440185 126.95106662996858 126.95106662996858 126.9510511734997 126.9510511734997 126.95103458266733 126.95103458266733 126.95102794266128 126.95102794266128 126.95102300994601 126.95102300994601 126.95101927499093 126.95101927499093 126.95101629785772 126.95101629785772 126.95101267371318 126.95101267371318 126.9510153508855 126.9510153508855 126.95101720774437 126.95101720774437 126.95102021043657 126.95102021043657 126.95101752088253 126.95101752088253 126.9510153956422 126.9510153956422 126.95101895055845 126.95101895055845 126.95102031957244 126.95102031957244 126.95102657104712 126.9517155 126.95104268646075 126.95104268646075 126.9510646962891 126.9510646962891 126.9510929489639 126.9510929489639 126.95112224186802 126.95112224186802 126.95114804243352 126.95114804243352 126.95117707273135 126.95117707273135 126.95121903168213 126.95121903168213 126.95126210850871 126.95126210850871 126.95124930909816 126.95124930909816 126.95129619649775 126.95129619649775 126.9513363094993 126.9513363094993 126.95138567806998 126.95138567806998 126.95143558593469 126.95143558593469 126.95145984310427 126.95145984310427 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.95147419698917 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 126.9520039 ];
rsrp = [-76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -77 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -75 -77 -77 -77 -77 -77 -77 -77 -79 -79 -76 -76 ];
cellID = [6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 ];
rssi = [-51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 -51 ];
cqi = [15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 8 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 11 11 11 11 11 11 11 11 11 11 11 12 12 12 12 12 12 12 12 8 8 11 11 ];



alt_mean = mean(altitude);
lat_mean = mean(latitude);
long_mean = mean(longitude);
rsrp_mean = mean(rsrp);

alt_std = std(altitude);
lat_std = std(latitude);
long_std = std(longitude);
rsrp_std = std(rsrp);

alt_cut = zeros(1,length(altitude));
lat_cut = zeros(1,length(latitude));
long_cut = zeros(1,length(longitude));
rsrp_cut = zeros(1,length(rsrp));

alt_cut = medfilt1(altitude);
rsrp = medfilt1(rsrp);
% rsrp2 = medfilt1(rsrp2);

lat_cut(1) = latitude(1);
for i = 2:length(latitude)
    if abs(latitude(i)-lat_cut(i-1))<0.5*lat_std
        lat_cut(i) = latitude(i);
    else
        lat_cut(i) = lat_cut(i-1);
    end
end

long_cut(1) = longitude(1);
for i = 2:length(longitude)
    if abs(longitude(i)-long_cut(i-1))<0.5*lat_std
        long_cut(i) = longitude(i);
    else
        long_cut(i) = long_cut(i-1);
    end
end

figure('DefaultAxesFontSize',32);
plot(alt_cut);
title("Altitude by time");
xlabel("sample index (2 sample/second)", 'FontSize', 32);
ylabel("Altitude (m)", 'FontSize', 32);

figure('DefaultAxesFontSize',32);
plot(rsrp);
title("RSRP by time");
xlabel("sample index (2 sample/second)", 'FontSize', 32);
ylabel("RSRP (dBm)", 'FontSize', 32);

figure('DefaultAxesFontSize',32);
lat_filt = smooth(lat_cut,50);
long_filt = smooth(long_cut,50);
plot(lat_filt,long_filt);
xlabel("latitude");
ylabel("longitude");
hold on
plot(lat_filt(1),long_filt(1),'o','MarkerSize',16,'MarkerEdgeColor','red','MarkerFaceColor','red');
plot(lat_filt(length(lat_filt)),long_filt(length(long_filt)),'o','MarkerSize',16,'MarkerEdgeColor','blue','MarkerFaceColor','blue');
title("Drone movement by time (RED to Blue)");


figure('DefaultAxesFontSize',32);
plot3(lat_filt, long_filt, rsrp);
xlabel("latitude");
ylabel("longitude");
zlabel("RSRP (dBm)");
title("RSRP for each GPS coordinate");



figure('DefaultAxesFontSize',32);
plot(cellID);
xlabel("sample index (2 sample/second)", 'FontSize', 32);
ylabel("cellID");
title("Cellular ID change by time");


figure('DefaultAxesFontSize',32);
yyaxis left;
plot(cellID);
xlabel("sample index (2 sample/second)", 'FontSize', 32);
ylabel("cellID");
yyaxis right;
plot(rsrp);
ylabel("RSRP (dBm)");
title("Cellular ID and RSRP");

% 
% figure('DefaultAxesFontSize',32);
% plot(rsrp);
% hold on
% rsrp2 = [-83 -83 -83 -83 -83 -83 -83 -83 -81 -81 -81 -80 -80 -76 -76 -76 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -70 -70 -70 -70 -70 -70 -68 -68 -68 -68 -68 -68 -70 -70 -70 -70 -70 -70 -70 -70 -76 -76 -76 -76 -76 -76 -76 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -80 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -78 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -76 -75 -75 -75 -75 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -79 -72 -72 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -73 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -71 -69 -69 -69 -69 -69 -69 -69 -69 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -68 -73 -73 -73 -76 -76 -80 -80 -80 -80 -80 -80 -80 -80 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -80 -80 -80 -80 -80 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -72 -69 -69 -69 -69 -69 -69 -69 -69 -69 -69 -69 -70 -70 -70 -70 -70 -70 -74 -74 -74 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -73 -73 -73 -73 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -74 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -75 -79 -79 -79 ];
% cellID = [6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 6288687 ];
% plot(rsrp2);



% figure('DefaultAxesFontSize',32);
% yyaxis left;
% plot(cellID);
% xlabel("sample index (2 sample/second)", 'FontSize', 32);
% ylabel("cellID");
% yyaxis right;
% plot(alt_cut);
% ylabel("altitude (m)");



% figure('DefaultAxesFontSize',32);
% plot(altitude,rsrp);
% xlabel("Altitude (m)", 'FontSize', 32);
% ylabel("RSRP (dBm)", 'FontSize', 32);



%%
% s = length(latitude);
% la = latitude(2:s);
% la = [la latitude(s)];
% gap = latitude - la;
% thres = 2.5e-5;
% % thres = std(gap);
% result = latitude;
% i = 1
% while i <= s
%     if gap(i) > thres
%         start = i-1;
%         t = i+1;
%         while gap(t) > thres
%             t = t+1;
%         end
%         last = t;
%     end
%     step = (latitude(last)-latitude(start))/(last-start);
%     result(i) = 0;
%     i = t;
%     i = i+1;
% end